"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[2693],{2693:(I,h,a)=>{a.r(h),a.d(h,{RegistroPageModule:()=>R});var P=a(177),f=a(4341),l=a(8974),d=a(8986),u=a(467),n=a(4438),C=a(7731),_=a(7291),M=a(2599),O=a(3366);const v=i=>({"rev-cod":!0,expired:i}),b=(i,g)=>({"all-inputs-filled":i,"not-all-inputs-filled":g}),F=[{path:"",component:(()=>{var i;class g{constructor(e,t,r,o,s,c){this.router=e,this.route=t,this.jwtService=r,this.storageService=o,this.sms=s,this.api=c,this.buttonText="Reenviar c\xf3digo",this.minutes=1,this.seconds=0,this.isExpired=!1,this.input1="",this.input2="",this.input3="",this.input4="",this.inputsFilled=!1}ngOnInit(){this.startTimer()}ngOnDestroy(){this.interval&&clearInterval(this.interval)}checkInputs(){this.inputsFilled=!!(this.input1&&this.input2&&this.input3&&this.input4)}reenviarCodigo(){var e=this;return(0,u.A)(function*(){let t=yield e.storageService.getItem("token");e.isExpired&&(e.route.queryParams.subscribe(r=>{let o="+51"+r.PHONE2,s=Math.floor(1e3+9e3*Math.random()),c="Blip informa: el codigo solicitado es "+s;e.saveDataSms(s),e.sms.sendSms(o,c,t).subscribe(m=>{console.log(m)},m=>{console.error("Error al enviar el mensaje:",m)})}),e.resetTimer())})()}startTimer(){this.interval=setInterval(()=>{this.seconds>0?this.seconds--:this.minutes>0?(this.minutes--,this.seconds=59):(clearInterval(this.interval),this.interval=null,this.buttonText="Reenviar c\xf3digo",this.isExpired=!0)},1e3)}resetTimer(){this.minutes=1,this.seconds=0,this.buttonText="Reenviar c\xf3digo",this.isExpired=!1,this.startTimer()}saveDataSms(e){var t=this;return(0,u.A)(function*(){yield t.storageService.removeItem("code-sms"),yield t.storageService.setItem("code-sms",e)})()}verifyOTP(){var e=this;return(0,u.A)(function*(){const t=parseInt(e.input1+""+e.input2+e.input3+e.input4);console.log(t);const r=yield e.storageService.getItem("code-sms");console.log(r);const o=yield e.storageService.getItem("token");t===r?e.api.getValidate(o).subscribe(function(){var s=(0,u.A)(function*(c){if(console.log(c),e.data=c.data,!0===e.data.isValidate){const y=yield e.getUserData(o),k=e.jwtService.generateTokenMain("TELEFONO",y,!0);yield e.storageService.removeItem("token"),yield e.storageService.setItem("token",k),e.router.navigate(["/home"])}});return function(c){return s.apply(this,arguments)}}(),s=>{console.error("Error al consumir el servicio:",s)}):alert("codigo incorrecto")})()}getUserData(e){var t=this;return(0,u.A)(function*(){return new Promise((r,o)=>{t.api.getInformation(e).subscribe(s=>{t.data=s.data,t.storageService.removeItem("user"),t.storageService.setItem("user",t.data);const c=Number(t.data.usu_id);r(c)},s=>{console.error("Error al consumir el servicio:",s),o(s.message)})})})()}}return(i=g).\u0275fac=function(e){return new(e||i)(n.rXU(d.Ix),n.rXU(d.nX),n.rXU(C.b),n.rXU(_.n),n.rXU(M.$),n.rXU(O.G))},i.\u0275cmp=n.VBU({type:i,selectors:[["app-registro"]],decls:28,vars:20,consts:[[3,"fullscreen"],[1,"wrapper"],[1,"login"],[1,"code-inputs"],["type","tel","maxlength","1","inputmode","numeric",3,"ngModelChange","ionChange","ngModel"],["id","open-toast",3,"click","ngClass","disabled"],[1,"TIME"],["trigger","open-toast","message","C\xf3digo enviado satisfactoriamente.","position","top","mode","md",1,"custom-toast",3,"duration"],["routerLink","/log-con",1,"ini-con",3,"click"],["routerLink","/ing-cor",1,"LA"],[1,"footer-btn"],[1,"bnt-dow"],["routerLink","/login",1,"bac"],[1,"nex",3,"click","ngClass"]],template:function(e,t){1&e&&(n.j41(0,"ion-content",0)(1,"div",1)(2,"div",2)(3,"h1"),n.EFF(4," Bienvenida , de nuevo! "),n.k0s(),n.j41(5,"p"),n.EFF(6," Ingresa el c\xf3digo de 4 d\xedgitos enviado al n\xfamero +51 923 092 610. "),n.k0s(),n.j41(7,"div",3)(8,"ion-input",4),n.mxI("ngModelChange",function(o){return n.DH7(t.input1,o)||(t.input1=o),o}),n.bIt("ionChange",function(){return t.checkInputs()}),n.k0s(),n.j41(9,"ion-input",4),n.mxI("ngModelChange",function(o){return n.DH7(t.input2,o)||(t.input2=o),o}),n.bIt("ionChange",function(){return t.checkInputs()}),n.k0s(),n.j41(10,"ion-input",4),n.mxI("ngModelChange",function(o){return n.DH7(t.input3,o)||(t.input3=o),o}),n.bIt("ionChange",function(){return t.checkInputs()}),n.k0s(),n.j41(11,"ion-input",4),n.mxI("ngModelChange",function(o){return n.DH7(t.input4,o)||(t.input4=o),o}),n.bIt("ionChange",function(){return t.checkInputs()}),n.k0s()(),n.j41(12,"button",5),n.bIt("click",function(){return t.reenviarCodigo()}),n.EFF(13),n.j41(14,"div",6),n.EFF(15),n.nI1(16,"number"),n.k0s()(),n.nrm(17,"ion-toast",7),n.j41(18,"button",8),n.bIt("click",function(){return t.verifyOTP()}),n.EFF(19,"iniciar sesi\xf3n con contrase\xf1a "),n.k0s(),n.j41(20,"h1",9),n.EFF(21,"He cambiado mi n\xfamero de tel\xe9fono"),n.k0s()(),n.j41(22,"footer",10)(23,"div",11)(24,"button",12),n.EFF(25,"Atr\xe1s"),n.k0s(),n.j41(26,"button",13),n.bIt("click",function(){return t.verifyOTP()}),n.EFF(27,"Siguiente"),n.k0s()()()()()),2&e&&(n.Y8G("fullscreen",!0),n.R7$(8),n.R50("ngModel",t.input1),n.R7$(),n.R50("ngModel",t.input2),n.R7$(),n.R50("ngModel",t.input3),n.R7$(),n.R50("ngModel",t.input4),n.R7$(),n.Y8G("ngClass",n.eq3(15,v,t.isExpired))("disabled",!t.isExpired),n.R7$(),n.SpI(" ",t.buttonText," "),n.R7$(2),n.Lme(" ",t.minutes,":",n.i5U(16,12,t.seconds,"2.0")," "),n.R7$(2),n.Y8G("duration",3e3),n.R7$(9),n.Y8G("ngClass",n.l_i(17,b,t.inputsFilled,!t.inputsFilled)))},dependencies:[P.YU,f.BC,f.tU,f.vS,l.W9,l.$w,l.op,l.Gw,l.N7,d.Wk,P.QX],styles:['@charset "UTF-8";ion-content[_ngcontent-%COMP%]{--background: #FFFFFF;--padding-start: 0;--padding-end: 0;--padding-top: 0;--padding-bottom: 0;display:flex;flex-direction:column;height:100%}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between;height:100%;padding:50px}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin-top:50px;font-size:30px;font-family:Poppins medium;margin-bottom:20px;font-family:Poppins;font-size:31px;width:200px}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Poppins;font-size:16px;font-weight:0}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]   .code-inputs[_ngcontent-%COMP%]{display:flex}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]   .code-inputs[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{width:50px;height:50px;margin:20px 5px 0;text-align:center;font-size:24px;border:1px solid rgba(138,149,158,.5);background-color:#f7f7f7;border-radius:10px}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]   .rev-cod[_ngcontent-%COMP%]{font-family:Poppins;display:flex;border:1px solid #C8C5CA;margin-top:50px;border-radius:30PX;background-color:#fff;padding:20px;font-weight:500}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]   .rev-cod[_ngcontent-%COMP%]   .TIME[_ngcontent-%COMP%]{margin-left:10PX;font-family:Poppins;font-weight:600}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]   .rev-cod.expired[_ngcontent-%COMP%]{background-color:#79ffaf;color:#212121;border:#79FFAF}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]   .ini-con[_ngcontent-%COMP%]{font-family:Poppins;display:flex;border:1px solid #212121;margin-top:20px;border-radius:30PX;color:#fff;background-color:#212121;padding:20px}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .login[_ngcontent-%COMP%]   .LA[_ngcontent-%COMP%]{display:flex;width:100%;text-align:center;justify-content:center;margin:90px 0 0;font-family:Poppins;font-size:15px;font-style:normal;font-weight:500;line-height:19px;letter-spacing:.18px;text-decoration-line:underline;color:#141414}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .bnt-dow[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-between;padding-bottom:20px}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .bnt-dow[_ngcontent-%COMP%]   .bac[_ngcontent-%COMP%]{border:1px solid #212121;background-color:#fff;padding-inline:10px;padding-top:15px;padding-bottom:15px;border-radius:30px;width:40%;font-size:15px;font-weight:600;color:#212121;font-family:Poppins,sans-serif}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .bnt-dow[_ngcontent-%COMP%]   .nex[_ngcontent-%COMP%]{border-radius:30px;border:1px solid #C8C5CA;background-color:#fff;padding-inline:10px;color:#c8c5ca;padding-top:15px;padding-bottom:15px;font-size:15px;width:40%;font-family:Poppins,sans-serif;font-weight:600}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .bnt-dow[_ngcontent-%COMP%]   .all-inputs-filled[_ngcontent-%COMP%]{background-color:#79ffaf;color:#212121;border:#79FFAF}ion-content[_ngcontent-%COMP%]   .wrapper[_ngcontent-%COMP%]   .bnt-dow[_ngcontent-%COMP%]   .all-inputs-filled[_ngcontent-%COMP%]{background-color:#79ffaf;color:#212121;font-size:15px;border:#79FFAF}.custom-toast[_ngcontent-%COMP%]{--background: #FFFFFF;--color: #212121;border-radius:8px}.custom-toast[_ngcontent-%COMP%]   .toast-message[_ngcontent-%COMP%]{padding:10px}']}),g})()}];let x=(()=>{var i;class g{}return(i=g).\u0275fac=function(e){return new(e||i)},i.\u0275mod=n.$C({type:i}),i.\u0275inj=n.G2t({imports:[d.iI.forChild(F),d.iI]}),g})(),R=(()=>{var i;class g{}return(i=g).\u0275fac=function(e){return new(e||i)},i.\u0275mod=n.$C({type:i}),i.\u0275inj=n.G2t({imports:[P.MD,f.YN,l.bv,x]}),g})()}}]);